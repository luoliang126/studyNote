# d3.js使用

1. ##### 基本使用

   ```js
   1、引入d3
   cdn方式：<script src="https://d3js.org/d3.v5.min.js"></script>
   es6方式：npm install d3
   		import * as d3 from 'd3'
   
   2、选择器(类似jq) select、selectAll
   d3.select("#id")
   d3.select("body").style("background-color", "black"); // 设置body背景色
   
   链式调用
   d3.selectAll("p")
   .data([4, 8, 15, 16, 23, 42])
   .style("font-size", function(d) { return d + "px"; });
   
   3、添加节点和元素 append、text、html
   <div class = "myclass">
   	Hello World!
   </div>
   d3.select("div.myclass").append("span");
   d3.select("div.myclass").append("span").text("from D3.js");
   d3.select("div.myclass").append("span").html("from D3.js");
   
   4、设置或更新样式。style
   d3.select("div.myclass").append("span").style('color','red');
   
   5、查看/添加/删除 class属性。classed
   d3.select(".myclass").classed("myanotherclass"); // 查看是否存在class---myanotherclass，有返回true，否则为false
   d3.select(".myclass").classed("myanotherclass", true); // 添加class
   d3.select(".myclass").classed("myanotherclass", false); //　删除class
   
   6、添加或更新所选元素的属性。attr
   const instance = d3.select('#id');
   instance.attr('name','luoliang');
   instance.attr('style','color:red'); // 样式也是属性，但不推荐这样操作，直接操作style更方便
   
   7、删除元素：remove、exit
   
   8、数据和图元绑定：datum\data\enter\exit
   <p id="p"></p>
   <ul id = "list">
       <li></li>
       <li></li>
   </ul>
   datum()方法用于为HTML文档中的单个元素设置值。
   d3.select("#p")
   	.datum(50)
       .text(function(d) { 
       	return "Used existing paragraph element and the data " + d; 
   	});
   data()为数组映射，这里虽然传了5条数据，但是界面只能渲染2条（从前往后），因为只有2个li
   d3.select("#list").selectAll("li")
      .data([10, 20, 30, 25, 15])      
      .text(function(d,i) { return d; }); // d是当前遍历的值，i是索引
   剩下的数据想渲染怎么办？enter()
   d3.select("#list").selectAll("li")
      .data([10, 20, 30, 25, 15])
      .text(function(d) { return "This is pre-existing element and the value is " + d; })
      .enter()
      .append("li")
      .text(function(d) { return "This is dynamically created element and the value is " + d; });
   exit()方法输出不再存在数据的图形元素集。
   
   9、过渡、动画：transition、duration、delay
   过渡效果：
   d3.select("#list").selectAll("li")
       .transition()
       .duration(3000)
       .delay(3000)
       .style("background-color",'red')
   定义过渡时长，这样方便传递参数做封装，注意transition放在动画前/后，都是可行的，delay必须跟在transition后面
   const t = d3.transition().duration(3000);
   d3.select("#list").selectAll("li")
   .style("background-color",'red')
   .transition(t)
   
   循环动画效果：定义一个函数，监听执行完后，再次执行，达到无限循环效果
   const li = d3.select("#list").selectAll("li")
   const runLi = () => {
       li
       .transition()
       .duration(1000)
       .delay(100)
       .ease(d3.easePolyInOut)
       .style("background-color",'red')
       .transition()
       .duration(1000)
       .delay(100)
       .ease(d3.easePolyInOut)
       .style("background-color",'green')
       .on('end',runLi)
   }
   runLi()
   ```

   

2. ##### 选择器

   ```js
   1、此方法用于选择根元素.此函数也可用于测试选择或扩展选择d3js.
   d3.selection()
   
   2、此方法用于选择与指定选择器字符串匹配的第一个元素.
   d3.select(selector)
   
   3、此方法选择与指定选择器字符串匹配的所有元素.
   d3. selectAll(selector)
   
   4、此方法用于选择元素.它选择与指定选择器字符串匹配的后代元素.返回选择中的元素按此选择中的相应父节点分组.如果没有元素匹配当前元素的指定选择器，或者选择器为null，则当前索引处的组将为空.
   selection.selectAll(selector)
   var b = d3.selectAll("p").selectAll("b");
   
   5、此方法用于过滤选择，返回包含的新选择只有指定过滤器为真的元素.
   selection.filter(filter)
   var even = d3.selectAll("tr").filter(":nth-child(odd) "); // 这里，过滤一系列表行只返回奇数
   
   6、此方法用于返回与指定的其他选择合并的新选择.
   selection.merge(other)
   var rect = svg.selectAll("rect").data(data); 
   rect.enter().append("rect").merge(rect);
   
   7、此方法用于分配指定的选择器.它返回一个返回true的函数.
   d3.matcher(选择器)
   var p = selection.filter(d3.matcher("p"));
   
   8、此方法用于分配指定的元素名称它返回一个函数，假设这是父元素，它会创建给定名称的元素.
   d3.creator(姓名)
   selection.append(d3.creator("p"));
   
   9、此方法用于为每个选定的元素调用指定的函数，由当前数据(d)，当前索引(i)和当前组(节点)传递的顺序，其中此作为当前DOM元素(nodes [i])
   selection.each(function)
   parent.each(function(p, j) {
      d3.select(this)
         .selectAll(".child")
         .text(function(d, i) { return "child " + d.name + " of " + p.name; });
   });
   
   10、它用于完全调用指定的函数一次
   selection.call(function [，arguments ...])
   
   function name(selection, first, last) {
      selection.attr("first-name", first).attr("last-name", last);
   }
   d3.selectAll("p").call(name，"Adam"，"David");
   
   11、D3 local允许您定义独立于数据的本地状态.
   d3.local()
   
   local.set(node，value)
   local.get(node)
   local.remove(node)
   ```

   

3. ##### 集合collection

4. ##### 数组

5. ##### 路径path

6. ##### 缩放scale

7. ##### 坐标轴axis

8. ##### 拖动drag

9. ##### 形状（弧形）

10. ##### 颜色color

11. ##### 请求数据

12. ##### 计时器timer

    ```js
    
    ```

    

13. ##### 图表

    ```js
    1、Bar Chart
    
    
    Circle Chart
    
    Pie Chart
    
    Donut Chart
    
    Line Chart
    
    Bubble Chart, etc.
    ```

    

14. 虚位以待！！